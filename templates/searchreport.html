<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
</head>
<body>
<table border="1">
    <tr>
        <td>Keyword</td>
        <td>Not complete grids</td>
        <td>Complete grids</td>
        <td>Total grids</td>
        <td>Report download</td>
    </tr>
    <tr>
        <td>All</td>
        <td>{{ allnotscan }}</td>
        <td>{{ allscan }}</td>
        <td>{{ all }}</td>
        <td></td>
    </tr>
    {% for k in keywords %}
        <tr>
        <td>{{ k.keyword }}</td>
        <td id="{{ forloop.counter0 }}-notcom">{{ k.notcomplete }}</td>
        <td id="{{ forloop.counter0 }}-com">{{ k.complete }}</td>
        <td id="{{ forloop.counter0 }}-total">{{ k.total}}</td>
        <td><a href="{{ k.link }}">Download</a></td>
    </tr>
    {% endfor %}
</table>
<script>
    var keywords = ['ธนาคาร',  'ATM',  'CDM',  'บริษัทเงินทุน',  'บริษัทเครดิตฟองซิเอร์',         'บริษัทหลักทรัพย์',  'ออมสิน',  'ธกส',  'ธอส',  'ธสน',  'ธนาคารอิสลาม',         'SME Bank',  'ประกัน',  'แคปปิตอล โอเค',  'เจเนอรัล คาร์ด เซอร์วิสเซส',         'ซิตี้ คอนซูเมอร์',  'เทสโก้ คาร์ด',  'บัตรกรุงไทย',  'บัตรกรุงศรีอยุธยา',         'อยุธยา แคปปิตอล',  'อิออน ธนสินทรัพย์',  'อีซี่บาย',  'ลิสซิ่ง',  'แฟคตอริ่ง',         'กรุงไทยธุรกิจลีสซิ่ง',  'แคปปิตอล โอเค',  'เงินติดล้อ',  'เงินสดทันใจ',         'จี แคปปิตอล',  'เจ เอ็ม ที เน็ทเวอร์ค เซอร์วิสเซ็ส',  'เจ เอ็ม ที พลัส',         'เจเนอรัล คาร์ด เซอร์วิสเซส',  'ซิงเกอร์ประเทศไทย',  'ซิตี้คอร์ป ลิสซิ่ง(ประเทศไทย)',         'ไซเบอร์เนตติคส์',  'โตโยต้าลิสซิ่ง',  'เทสโก้ คาร์ด เซอร์วิสเซส',  'ไทยพาณิชย์ลีสซิ่ง',         'ไทยเอซ แคปปิตอล',  'บัตรกรุงไทย',  'บัตรกรุงศรีอยุธยา',  'พรอมิส (ประเทศไทย)',         'มีนาลิสซิ่ง',  'เมืองไทย ลิสซิ่ง',  'แมคคาเล กรุ๊พ',  'รีโซลูชั่น เวย์',  'วัฒนาธนวินทรัพย์',         'วี แคช เอ็นเตอร์ไพรส์',  'ศักดิ์สยามพาณิชย์ลิสซิ่ง',  'สยามเจเนอรัลแฟคตอริ่ง',  'สินมิตร',         'อยุธยา แคปปิตอล เซอร์วิสเซส',  'อยุธยา แคปปิตอล ออโต้ ลีส',  'อินเทลลิเจนท์ ทีที. พาวเวอร์',         'อิออน ธนสินทรัพย์ (ไทยแลนด์)',  'อีซี่ บาย',  'เอเซียเสริมกิจลีสซิ่ง',  'ไอร่า แอนด์ ไอฟุล',         'เงินติดล้อ',  'เงินสดทันใจ',  'โดเมสติค แคปปิตอล 2015',  'ทีเค เงินสดทันใจ',         'ไทยเอช แคปปิตอล',  'ปิยะระยองกรุ๊ป',  'พี.เอส.เอ็น.ลีสซิ่ง',  'มีนาลีสซิ่ง',         'เมืองไทย ลีสซิ่ง',  'แมคคาเล กรุ๊พ',  'ไมด้า ลีสซิ่ง',  'สหไพบูลย์(2558)',         'อินเทลลิเจนท์ ทีที พาวเวอร์',  'พสิษฐ์ภาคิณ',  'สหกรณ์',  'กลุ่มเกษตกร',  'กลุ่มอาชีพ',         'กองทุนหมู่บ้าน',  'ออมทรัพย์เพื่อการผลิต',  'การเงินชุมชน',  'กลุ่มสัจจะ',  'family mart',         'max valu',  'max value',  '108 shop',  'cp freshmart',  'บิ๊กซี',  'เทสโก้',         'makro',  'ห้างสรรพสินค้า',  'ศูนย์การค้า',  'ไปรษณีย์',  'AIS',  'telewiz',  'เทเลวิซ',         'ทรูช็อป',  'Dtac',  'ดีแทค',  'ศูนย์บริการ ทีโอที',  'ศูนย์บริการ TOT',  'เจมาร์ท',         'ปั๊มน้ำมัน',  'ตู้เติมเงิน'];

    // using jQuery
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    function update_table(i, keyword){
        $.post("/places/gridstatus/",
            {
                keyword: keyword,
                csrfmiddlewaretoken: getCookie('csrftoken'),
            },
            function(data,status){
                var pl = jQuery.parseJSON(data);
                //var ss = "#"+ i.toString() +"-notcom"
                $("#"+ i.toString()+"-notcom").html(pl.notcomplete);
                $("#"+ i.toString()+"-com").html(pl.complete);
                $("#"+ i.toString()+"-total").html(pl.total);
                //$('#'+keywords[i]+'com').val(data.complete);
            });
    }

    $(document).ready(function(){
        for(var i=0; i<keywords.length; i++){
            update_table(i, keywords[i]);
            //console.log(keywords[i]);
            //console.log(i);
        }
    });
</script>
</body>
</html>